<template> <div class="ui mini modal" id="modifyBeepModal"> <div class="header">Modify Beep</div><i class="close icon"> </i> <div class="content"> <div class="ui negative message" v-if="errMessage.length !==0"> <div class="header item">Error</div><ul> <li :key="messages.code" v-for="messages in errMessage">{{messages}}</li></ul> </div><form class="ui form" :class="loading?'loading':''" @submit.prevent="confirmEdit()"> <div class="field"> <label>Plate Number</label> <input v-model="beepID.plate_number" type="text" name="fname" placeholder="Enter First Name" autoComplete="off"> </div><div class="field"> <label>Model</label> <input v-model="beepID.model" type="text" name="fname" placeholder="Enter First Name" autoComplete="off"> </div><div class="field"> <label>Route</label> <select v-model="beepID.route" class="ui fluid dropdown"> <option :key="route.route" v-for="route in routes" :value="'Route '+route.route+': '+route.name">Route{{route.route}}:{{route.name}}</option> </select> </div><div class="ui divider"></div><button class="ui fluid red button" type="button" @click="showDelBeep()">Delete Beep</button> <div class="ui divider"></div><button class="ui green fluid button" type="submit">Confirm Edits</button> </form> </div><success :content="SucceedContent"/> <delBeep :beepID="beepID"/> </div></template><script>import delBeep from '@/Component/Modals/DeleteBeep'import{required}from '@/utils/validations.js'import success from '@/Component/SuccessPopUp'import $ from 'jquery';window.$=window.jQuery=$;export default{components:{success, delBeep}, props:{beepID:{type: Object,},}, data(){return{loading: false, SucceedContent: '', errMessage: [], routes: []}}, methods:{routeList(){var $this=this this.$db.collection('route') .get() .then(function(querySnapshot){querySnapshot.forEach(function(doc){$this.routes.push(doc.data())})})}, showDelBeep(){$('#delBeepModal').modal('show')}, confirmEdit(){var $this=this var count=0 this.loading=true this.errMessage=[] this.errMessage.push(required(this.beepID.beepid,'Unit Number')) this.errMessage.push(required(this.beepID.model,'Beep Model')) this.errMessage.push(required(this.beepID.plate_number,'Plate Number')) this.errMessage.push(required(this.beepID.route,'Route')) /*Splicing non-errors in the arrays*/ count=this.errMessage.length while(count--){if (this.errMessage[count].length < 1){this.errMessage.splice(count, 1);}}if(this.errMessage.length < 1){this.loading=true $this.$db.collection("busUnit").doc($this.beepID.beepid) .update({model: $this.beepID.model, plate_number: $this.beepID.plate_number, route: $this.beepID.route, date_updated: new Date()}) /*Unset fields and perform animation succeed*/ .then(function(){$('#successModal').modal('show') $this.SucceedContent='New Beep has been added!' $this.loading=false $this.beepID.model='' $this.beepID.plate_number='' $this.beepID.route=''})}else{this.loading=false}}}, mounted(){this.routeList()}}</script>