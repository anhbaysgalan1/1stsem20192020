<template> <div class="ui mini modal" id="changePassModal"> <div class="header">Change Password</div><div class="content"> <div class="ui negative message" v-if="errMessage.length !==0"> <div class="header item">Error</div><ul> <li :key="messages.code" v-for="messages in errMessage">{{messages}}</li></ul> </div><form class="ui form" :class="loading?'loading':''" @submit.prevent="confirmPass()"> <div class="field"> <label>Old Password</label> <input type="password" maxlength="12" v-model="inputs.oldPass"> </div><div class="field"> <label>New Password</label> <input type="password" maxlength="12" v-model="inputs.newPass"> </div><div class="field"> <label>Retype New Password</label> <input type="password" maxlength="12" v-model="inputs.reNewPass"> </div><div class="ui divider"></div><div class="ui two column grid"> <div class="column"> <button class="ui green fluid button" type="submit">Confirm</button> </div><div class="column"> <button class="ui primary fluid button" type="button" @click="cancelModal()">Cancel</button> </div></div></form> </div><success :content="SucceedContent"></success> </div></template><script>import success from '@/Component/SuccessPopUp'import firebase from 'firebase/app'var config={apiKey: 'AIzaSyAhJjt15mqS0p7a1a77TF8zDm6EHjVuoYQ', authDomain: 'firebase-adminsdk-v2kv5@beep-db-d2d2b.iam.gserviceaccount.com', databaseURL: "https://beep-db-d2d2b.firebaseio.com",};var passChangeAdmin=firebase.initializeApp(config,"Fifth")import $ from 'jquery';window.$=window.jQuery=$;export default{components:{success}, props:{creds:{},}, data(){return{SucceedContent: '', errMessage: [], loading: false, inputs:{oldPass:'', newPass:'', reNewPass:''}}}, methods:{confirmPass(){var $this=this this.loading=true $this.errMessage=[] passChangeAdmin .auth() .signInWithEmailAndPassword($this.creds.email,$this.creds.password) .then(function(){var user=passChangeAdmin.auth().currentUser if($this.creds.password===$this.inputs.oldPass){if($this.inputs.newPass===$this.inputs.reNewPass){user.updatePassword($this.inputs.newPass) .then(function(){$this.$db.collection('admin') .doc(user.uid) .update({password: $this.inputs.newPass}) $this.inputs.oldPass='' $this.inputs.newPass='' $this.inputs.reNewPass='' $this.loading=false $this.SucceedContent='Password has changed!' passChangeAdmin.auth().signOut() $('#successModal').modal('show')}) .catch(function(error){$this.inputs.oldPass='' $this.inputs.newPass='' $this.inputs.reNewPass='' $this.loading=false passChangeAdmin.auth().signOut() $this.errMessage.push(error.message)})}else{$this.inputs.oldPass='' $this.inputs.newPass='' $this.inputs.reNewPass='' $this.loading=false passChangeAdmin.auth().signOut() $this.errMessage.push("The passwords didn't match")}}else{$this.inputs.oldPass='' $this.inputs.newPass='' $this.inputs.reNewPass='' $this.loading=false passChangeAdmin.auth().signOut() $this.errMessage.push("Wrong old password!")}})}, cancelModal(){$('#changePassModal').modal('hide')}}}</script>