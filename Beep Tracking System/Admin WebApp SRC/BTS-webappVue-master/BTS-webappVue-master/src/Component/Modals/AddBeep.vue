<template> <div> <div class="ui tiny modal" id="beepModal"> <div class="header" id="header">Add New Beep</div><div class="content"> <div class="ui negative message" v-if="formStatus.errMessage.length !==0"> <div class="header item">Error</div><ul> <li :key="messages.code" v-for="messages in formStatus.errMessage">{{messages}}</li></ul> </div><form class="ui form" @submit.prevent="checkForm()" :class="formStatus.loading?'loading':''"> <div class="ui two column grid" autocomplete="off"> <div class="column"> <div class="field" :class="input.unit?'error':''"> <label>Beep Unit</label> <input v-model="beep.unit" type="text" name="fname" placeholder="Enter First Name" autoComplete="off"> </div></div><div class="column"> <div class="field" :class="input.plate_number?'error':''"> <label>Plate Number</label> <input v-model="beep.plate_number" type="text" name="lname" placeholder="Enter Last Name" autoComplete="off"> </div></div></div><div class="ui two column grid"> <div class="column"> <div class="field" :class="input.model?'error':''"> <label>Model</label> <input v-model="beep.model" type="text" name="lname" placeholder="Enter Last Name" autoComplete="off"> </div></div><div class="column"> <div class="field" :class="input.route?'error':''"> <label>Route</label> <select v-model="beep.route" class="ui fluid dropdown"> <option :key="route.route" v-for="route in routes" :value="route.route">Route{{route.route}}:{{route.name}}</option><!-- <option value="Route 1: City Hall - IT Park">Route 1: City Hall - IT Park</option> <option value="Route 2: Banawa - Panagdait">Route 2: Banawa - Panagdait</option> <option value="Route 3: Guadalupe - Colon">Route 3: Guadalupe - Colon</option> --> </select> </div></div></div><div class="actions"> <div class="ui two column grid"> <div class="column"> <button class="ui fluid green button" type="submit">Add</button> </div><div class="column"> <button class="ui fluid deny red button" type="button">Cancel</button> </div></div></div></form> </div></div><success :content="SucceedContent"></success> </div></template><script>import{required}from '@/utils/validations.js'import success from '@/Component/SuccessPopUp'import $ from 'jquery';window.$=window.jQuery=$;export default{components:{success,}, mounted(){this.routeList()}, data(){return{SucceedContent: '', formStatus:{loading: false, errMessage: []}, input:{unit: false, model: false, plate_number: false, route: false,}, beep:{unit: '', model: '', plate_number: '', route: '',}, routes: []}}, methods:{routeList(){var $this=this this.$db.collection('route') .get() .then(function(querySnapshot){querySnapshot.forEach(function(doc){$this.routes.push(doc.data())})})}, checkForm(){var $this=this var count=0 this.formStatus.loading=true this.formStatus.errMessage=[] this.formStatus.errMessage.push(required(this.beep.unit,'Unit Number')) this.formStatus.errMessage.push(required(this.beep.model,'Beep Model')) this.formStatus.errMessage.push(required(this.beep.plate_number,'Plate Number')) this.formStatus.errMessage.push(required(this.beep.route,'Route')) /*Splicing non-errors in the arrays*/ count=this.formStatus.errMessage.length while(count--){if (this.formStatus.errMessage[count].length < 1){this.formStatus.errMessage.splice(count, 1);}}if(this.formStatus.errMessage.length < 1){this.formStatus.loading=true $this.sendForm(this.beep.unit)}}, sendForm(){var $this=this $this.$db.collection("busUnit").doc($this.beep.unit) .set({beepid: $this.beep.unit, model: $this.beep.model, plate_number: $this.beep.plate_number, route: $this.beep.route, status: 'Garage', date_created: new Date(), date_updated: new Date()}) /*Unset fields and perform animation succeed*/ .then(function(){$('#successModal').modal('show') $this.SucceedContent='New Beep has been added!' $this.formStatus.loading=false $this.beep.unit='' $this.beep.model='' $this.beep.plate_number='' $this.beep.route=''})},}}</script>